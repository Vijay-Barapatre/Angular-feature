<!-- USE CASE 2: Singleton vs Component-Scoped Services -->

<div class="use-case-container fade-in">
    <!-- Header -->
    <div class="page-header">
        <a routerLink="/services-di" class="back-link">â† Back to Overview</a>
        <h1>ğŸ”¢ Use Case 2: Singleton vs Component-Scoped</h1>
        <p class="header-description">
            Understand how the same service can be a singleton OR have separate instances
            depending on where it's provided.
        </p>
    </div>

    <!-- Concept Explanation -->
    <section class="concept-section">
        <h2>ğŸ¯ Key Concept</h2>
        <div class="comparison-grid">
            <div class="comparison-card singleton">
                <h3>ğŸŒ Singleton (providedIn: 'root')</h3>
                <ul>
                    <li>ONE instance for the entire app</li>
                    <li>Shared state across all components</li>
                    <li>Created at app startup</li>
                    <li>Tree-shakable if not used</li>
                </ul>
            </div>
            <div class="comparison-card component">
                <h3>ğŸ”’ Component-Scoped (providers: [...])</h3>
                <ul>
                    <li>NEW instance per component</li>
                    <li>Isolated state, not shared</li>
                    <li>Created when component loads</li>
                    <li>Destroyed with component</li>
                </ul>
            </div>
        </div>
    </section>

    <!-- Interactive Demo -->
    <section class="demo-section">
        <h2>ğŸ§ª Interactive Demo</h2>

        <!-- Parent Panel -->
        <div class="parent-panel">
            <div class="panel-header">
                <span class="icon">ğŸ‘¨â€ğŸ’¼</span>
                <h3>Parent Component (Root Singleton)</h3>
            </div>
            <div class="panel-body">
                <div class="instance-info">
                    <span class="label">Instance ID:</span>
                    <span class="value">{{ counterService.instanceId }}</span>
                </div>
                <div class="counter-display">
                    <span class="count">{{ counterService.count }}</span>
                </div>
                <div class="button-group">
                    <button (click)="counterService.decrement()" class="btn btn-outline">-</button>
                    <button (click)="counterService.increment()" class="btn btn-primary">+</button>
                </div>
            </div>
        </div>

        <!-- Children Grid -->
        <div class="children-grid">
            <app-use-case-2-child-a></app-use-case-2-child-a>
            <app-use-case-2-child-b></app-use-case-2-child-b>
        </div>

        <!-- Observation Box -->
        <div class="observation-box">
            <h4>ğŸ‘€ Observe the Instance IDs:</h4>
            <ul>
                <li><strong>Parent & Child B</strong>: <span class="same">SAME ID</span> â†’ Same singleton instance</li>
                <li><strong>Child A</strong>: <span class="different">DIFFERENT ID</span> â†’ Own isolated instance</li>
                <li>Clicking +/- on Parent also changes Child B's counter! They share the service.</li>
                <li>Child A's counter is completely independent.</li>
            </ul>
        </div>
    </section>

    <!-- Code Comparison -->
    <section class="code-section">
        <h2>ğŸ’» Code Comparison</h2>

        <div class="code-grid">
            <div class="code-block isolated">
                <div class="code-header">
                    <span class="file-name">child-a.component.ts</span>
                    <span class="badge warning">Own Instance</span>
                </div>
                <pre><code>&#64;Component(&#123;
  selector: 'app-child-a',
  // ğŸ”‘ Creates NEW instance!
  providers: [CounterService]
&#125;)
export class ChildAComponent &#123;
  constructor(
    private counter: CounterService
  ) &#123;&#125;
&#125;</code></pre>
            </div>

            <div class="code-block shared">
                <div class="code-header">
                    <span class="file-name">child-b.component.ts</span>
                    <span class="badge primary">Uses Singleton</span>
                </div>
                <pre><code>&#64;Component(&#123;
  selector: 'app-child-b',
  // No providers! Uses root
&#125;)
export class ChildBComponent &#123;
  constructor(
    private counter: CounterService
  ) &#123;&#125;
&#125;</code></pre>
            </div>
        </div>
    </section>

    <!-- When To Use -->
    <section class="tips-section">
        <h2>ğŸ’¡ When To Use Each</h2>
        <div class="tips-grid">
            <div class="tip-card">
                <h4>Use Singleton When:</h4>
                <ul>
                    <li>Sharing auth state across app</li>
                    <li>Global configuration</li>
                    <li>Application-wide cache</li>
                    <li>Cross-component communication</li>
                </ul>
            </div>
            <div class="tip-card">
                <h4>Use Component-Scoped When:</h4>
                <ul>
                    <li>Each instance needs isolated state</li>
                    <li>Multiple forms on same page</li>
                    <li>Reusable widgets with own data</li>
                    <li>Cleanup is important (destroys with component)</li>
                </ul>
            </div>
        </div>
    </section>
</div>